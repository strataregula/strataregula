# 🔒 セキュリティ監査カバレッジSaaS 事業構想

> **⚠️ 最高機密** — この文書は社内限定・転送禁止。閲覧ログを残すこと。Issue/PRへの直リンクは貼らない（要マスキング）。

**機密レベル**: 最高機密  
**アクセス権限**: 経営陣・承認されたプロジェクトメンバーのみ  
**作成日**: 2025-08-31

---

## 🎯 要旨（One-Liner）

**「全部チェックしました」を保証する"監査カバレッジ"SaaS。**

3つの数値だけで運用：
- **ファイル監査カバレッジ**（例：43/43 = 100%）
- **危険パターン検出件数**（例：0件）
- **個別判定証跡充足率**（例：100%）

新人でも迷わない **緑/赤の判定** と **監査に耐える証跡** を自動生成。

---

## 🌍 背景・市場分析

### 現在の課題
- 既存OSS（Semgrep/Gitleaks/Trivy…）は強力だが**統合・運用が煩雑**
- 「人の暗黙知」に依存 → **AI/自動化の時代にスケールしない**
- セキュリティツールの乱立により、一貫性のない判定が発生

### 成功モデル分析
- **Codecov/Coveralls**: "**カバレッジ**"という**単純指標**で普及
- **Semgrep**: 2,000+コミュニティルール、PyPI配布で成功
- **新たな機会**: セキュリティも **Coverage × Evidence** で同じ構造を作る

---

## 💰 ビジネスモデル

### 🎯 完全にCodecovパクリ戦略

#### 無料版（Community）
- **基本パターン**: 1,000個の標準セキュリティルール
- **リポジトリ数**: 5個まで
- **基本レポート**: CSV/JSON出力
- **コミュニティサポート**: GitHub Issues

#### Pro版（$10/user/month）
- **精密パターン**: 5,000個の高精度ルール
- **誤検知対策**: AI支援による精密フィルタリング
- **無制限リポジトリ**: プライベートリポジトリ対応
- **高度なレポート**: SARIF、SPDX、カスタムフォーマット
- **Slack/Teams連携**: リアルタイム通知
- **優先サポート**: 24時間以内応答

#### Enterprise（カスタム価格）
- **独自パターン**: カスタムルールセット開発
- **オンプレミス**: エアギャップ環境対応
- **RBAC**: 詳細な権限管理
- **監査ログ**: SOC2/ISO27001対応
- **専任サポート**: テクニカルアカウントマネージャー

---

## 🏗️ アーキテクチャ概観

```mermaid
graph TD
  A[PR/Push] --> B[CI: Orchestrator]
  B --> C1[Scanners<br/>Gitleaks / Semgrep / Trivy]
  B --> C2[PolicyPack<br/>registry]
  C1 --> D[Audit Engine]
  C2 --> D
  D --> E[AuditRecord JSON<br/>(evidence+decision)]
  E --> F[PR Summary / AUDIT.md]
  E --> G[Artifacts / Baseline]
```

### 主要コンポーネント

#### 1. パッケージマネージャー配布
Semgrep の PyPI 配布と同様：
```bash
pip install security-audit-patterns
security-audit --config p/secrets  # 超シンプル！
```

#### 2. CDN + API配布
Semgrep Registry の --config p/python と同じ仕組み：
```
patterns.security-audit.io/api/v1/rulesets/secrets.yaml
```

#### 3. GitHub連携（コミュニティ）
semgrep/semgrep-rules リポジトリと同様のモデル

---

## 💡 新人フレンドリーな設計

### 設定ファイル1個だけ
```yaml
# .security-audit.yaml
rulesets: ["p/secrets", "p/malware"]
auto_update: true
# 終了！
```

### 判定も単純
```
✅ 43/43ファイル スキャン完了 (100%)
❌ 2件の問題発見
📋 全ファイル監査証跡あり
```

---

## ⚡ 技術的優位性

### 1. 差分更新システム
- 新しい脅威パターンを**24時間以内**に全ユーザーに配布
- ゼロダウンタイム更新
- ロールバック機能

### 2. 誤検出対策
- **Pro版**: AI支援による低False Positive率
- 機械学習による継続的改善
- ユーザーフィードバックの自動反映

### 3. 責任追跡システム
- 「AUDIT: ファイル名 - 判定理由」を完全実装
- 監査証跡の自動生成
- コンプライアンス要件への自動対応

---

## 🚀 MVP スコープ（Phase 1）

### 実装済み機能
- ✅ 秘密情報監査（PowerShell + GitLeaks）
- ✅ `.devcontainer/*` の重点監査
- ✅ GitHub Actions CI/CD統合
- ✅ Pre-commit hooks
- ✅ 包括的テストスイート

### Phase 1 残タスク
- [ ] **個別ファイル安全性監査証跡**（`AUDIT.md` 自動生成）
- [ ] **Shadow モード**（Failさせずにデータ収集）
- [ ] 依存&SASTの**非ブロッキング**可視化
- [ ] Web Dashboard（基本版）

### 非ゴール（Phase 1では実装しない）
- 完全SaaS/課金システム
- DLP網羅
- 社外通知連携
- 大規模RBAC

---

## 📊 KPI・成功指標

### プロダクトメトリクス
- **Audit Coverage**: ≥ 99%
- **Evidence Rate**: = 100%
- **False Positive率**: < 5%
- **検出精度（Precision/Recall）**: > 95%

### ビジネスメトリクス
- **月間アクティブユーザー**: 1,000+ (6ヶ月目標)
- **Pro版転換率**: 15%
- **チャーン率**: < 5%
- **NPS**: > 50

### 運用メトリクス
- **MTTT（triage時間）**: < 30分
- **Allowlist Drift**: < 10% (月次)
- **システム可用性**: > 99.9%

---

## 🗺️ ロードマップ

### Phase 1 (Q1 2025) - MVP
- Secret監査 + 依存/SAST可視化
- AUDIT.md 自動生成
- Shadow モード
- 基本Web Dashboard

### Phase 2 (Q2 2025) - Enhanced
- NVD/KEV連携
- 優先度スコア算出
- Top5脅威提示
- Slack/Teams連携
- 有料プラン開始

### Phase 3 (Q3 2025) - Enterprise
- 署名/監査ログ保全
- 詳細権限モデル
- オンプレミス対応
- カスタムルール開発支援

### Phase 4 (Q4 2025) - Scale
- AI支援による自動修正提案
- 多言語対応（Java, Go, Rust）
- 業界特化パック（金融、医療、政府）

---

## ⚠️ リスクと対策

### 技術リスク
| リスク | 影響度 | 対策 |
|-------|-------|------|
| **誤検知の蓄積** | 高 | Allowlist運用 + 合成データの回帰テスト |
| **過検知疲れ** | 中 | 可視化のみ→段階的Fail（Shadow→Gradual） |
| **ルール劣化** | 中 | 月次review、canary pack、Coverage Gate同等の%管理 |
| **競合追随** | 高 | 特許出願、独自アルゴリズムの開発 |

### 事業リスク
| リスク | 影響度 | 対策 |
|-------|-------|------|
| **既存プレイヤーの対応** | 高 | 差別化機能の継続開発、ユーザー体験の向上 |
| **市場の成長鈍化** | 中 | 隣接市場（DevSecOps、コンプライアンス）への展開 |
| **人材確保** | 中 | リモートワーク、競争力のある報酬体系 |

---

## 💼 組織・実行体制

### コアチーム
- **プロダクトマネージャー**: 1名
- **リードエンジニア**: 1名（セキュリティ専門）
- **フルスタックエンジニア**: 2名
- **DevOpsエンジニア**: 1名
- **セキュリティリサーcher**: 1名

### 外部パートナー
- **セキュリティ監査会社**: 四半期評価
- **法務・コンプライアンス**: 規制対応
- **マーケティングエージェンシー**: ブランディング

---

## 🔐 機密保持・セキュリティ

### 情報管理
- **アクセス制御**: 必要最小限の原則
- **監査ログ**: 全アクセスの記録・監視
- **データ暗号化**: 保存時・転送時ともに暗号化

### 開発セキュリティ
- **コードレビュー**: 全変更の必須レビュー
- **セキュリティテスト**: 自動化されたセキュリティスキャン
- **インシデント対応**: 24時間以内の初期対応

---

## 📈 財務予測（概算）

### 初期投資（Phase 1）
- **人件費**: 1,500万円/年 × 6名
- **インフラ**: 300万円/年
- **開発ツール**: 200万円/年
- **法務・特許**: 500万円
- **合計**: 約1億円/年

### 収益予測（3年目）
- **ユーザー数**: 10,000名
- **Pro版転換**: 1,500名 × $120/年 = $180,000
- **Enterprise**: 50社 × $10,000/年 = $500,000
- **合計売上**: $680,000（約1億円）

### 損益分岐点
- **18ヶ月目**: 月次損益分岐
- **30ヶ月目**: 累積損益分岐

---

## 📝 次のアクション

### 即座に実施
- [ ] MVP機能の完成（Phase 1残タスク）
- [ ] α版テスターの募集（社内＋パートナー企業）
- [ ] 特許出願準備（核心アルゴリズム）

### 30日以内
- [ ] β版リリース（限定ユーザー）
- [ ] 初期ユーザーフィードバック収集
- [ ] プライシング戦略の最終決定

### 90日以内
- [ ] 正式版リリース
- [ ] Pro版の提供開始
- [ ] マーケティング施策の実行

---

## 📞 関連リソース

### 内部文書
- **技術仕様**: `docs/technical/`
- **実装ガイド**: `docs/security/implementation-guide.md`
- **テスト結果**: `tests/security/`

### 外部参考資料
- **Codecov価格体系**: [非公開]
- **Semgrep成功事例**: [非公開]
- **市場調査レポート**: [非公開]

---

**結論**: Semgrep + Codecov の成功要因を組み合わせて、**「セキュリティ版コードカバレッジ」** として展開。新人でも絶対に間違えない仕組みで、確実にビジネス成立の見込みあり。

---

> **⚠️ 重要**: この文書は最高機密情報です。
> - 社外への漏洩は厳禁
> - アクセスログは全て記録されています
> - 質問・相談は承認されたチャネルでのみ行ってください